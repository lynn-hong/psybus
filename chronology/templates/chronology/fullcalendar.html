{% extends "chronology/base.html" %}
{% load staticfiles %}

{% block contents_body %}

<link href="{% static 'fullcalendar-3.8.2/fullcalendar.min.css' %}" rel='stylesheet' />
<link href="{% static 'fullcalendar-3.8.2/fullcalendar.print.min.css' %}" rel='stylesheet' media='print' />
<link href="{% static 'fullcalendar-3.8.2/lib/jquery-ui.css' %}" rel='stylesheet' />

<script src="{% static 'fullcalendar-3.8.2/lib/jquery.min.js' %}"></script>
<script src="{% static 'fullcalendar-3.8.2/lib/jquery-ui.min.js' %}"></script>
<!--<script src="http://code.jquery.com/jquery-migrate-1.2.1.min.js"></script>-->
<script src="{% static 'plugins/jquery.qtip-1.0.js' %}"></script>
<script src="{% static 'fullcalendar-3.8.2/lib/moment.min.js' %}"></script>
<script src="{% static 'fullcalendar-3.8.2/fullcalendar.min.js' %}"></script>

<script>
    $(document).ready(function() {
        $('#calendar').fullCalendar({
            defaultView: 'agendaWeek',
            header: {
                left: 'prev,next today',
                center: 'title',
                right: 'agendaWeek,month,agendaDay,listWeek'
              },
            defaultDate: new Date(),
            minTime: "08:00:00",
            maxTime: "24:00:00",
            editable: true,
            selectable: true,
            disableResizing: true,
            eventLimit: true, // allow "more" link when too many events
            events: [
                {% for e in events %}
                {
                    title: "{{ e.title}}",
                    start: '{{ e.start }}',
                    end: '{{ e.end }}',
                    location: '{{ e.location }}',
                    description: "{% autoescape off %}{{ e.desc|escapejs }}{% endautoescape %}",
                    url: '{{ e.url }}'
                },
                {% endfor %}
            ],

            eventRender: function (event, element) {
                element.attr('href', 'javascript:void(0);');
                element.click(function() {
                    $("#startTime").html(moment(event.start).format('YYYY-MM-DD h:mm A'));
                    $("#endTime").html(moment(event.end).format('YYYY-MM-DD h:mm A'));
                    $("#eventLocation").html(event.location);
                    $("#eventInfo").html(event.description);
                    $("#eventLink").attr('href', event.url);
                    $("#eventContent").dialog({ modal: true,
                                                title: event.title,
                                                width: 'auto',
                                                height: 'auto',
                                                maxWidth: 350,
                                                maxHeight: 500
                    });
                });
            }


        });
    });
</script>

<div class="container" style="margin-top: 120px;">
   <div id="calendar"></div>
</div>

<div id="eventContent" title="Event Details" style="display:none">
    시작 시간: <span id="startTime"></span><br>
    종료 시간: <span id="endTime"></span><br>
    장소: <span id="eventLocation"></span><br><br>
    <p id="eventInfo"></p>
    <p><strong><a id="eventLink" href="" target="_blank">이벤트 자세히 보기</a></strong></p>
</div>


{% endblock %}
